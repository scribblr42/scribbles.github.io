---
layout: post
title: FIXED Level of Detail Intricacies; a Case Study
date: '2015-11-04T09:30:00.000Z'
author: VizScribbler
tags:
- level of detail
- lod
- tableau
- tableau desktop
modified_time: '2019-12-24T15:18:57.385Z'
blogger_id: tag:blogger.com,1999:blog-5138343082934398153.post-4918029928147505105
blogger_orig_url: https://vizscribbler.blogspot.com/2015/11/fixed-level-of-detail-intricacies-case.html
---

<i>This blog was originally posted on The Information Lab:&nbsp;https://www.theinformationlab.co.uk/2015/11/04/fixed-level-detail-intricacies-case-study/</i><br /><b><br /></b><b>Preamble</b><br />Level of detail calculations are super duper tricky - Having used Tableau for the last four months at an intensive pace and level, I find myself steering away from level of detail where I can. So when an instance occurs when I need to use it, I either find myself thinking it through with minute detail, or referring back to a session with had <i>the Queen of LOD's,</i> Bethany Lyons - My notes actually come in handy in this instance!<br />As some of you may be aware, the Data School have already recruited for the next cohort of Data Padawans that The Information Lab are looking to mould into awesome Data Consultants. This intensive process included (as you can read <a href="http://www.thedataschool.co.uk/andy-kriebel/we-are-hiring/" rel="noopener" target="_blank">here</a>) a simple Tableau creation process, and followed by&nbsp;each interviewee getting given a similar data set. The beauty of this? Not only is it a chance to experience the world of Tableau and really get to grips with how it works, but it is also an opportunity to ask questions, learn and develop your skills as Andy and the rest of the team are always happy to answer questions, critique and help the interviewees during the process. This is an amazing opportunity for feedback, especially (in my experience anyway), a large amount of applications and notes made during the process disappear into the netherworld, never to be seen or heard from again. The transparency is amazing.<br /><br /><b>The Exercise</b><br />Back to the purpose of this post - As a warm-up a few weeks ago as the Data School training was winding down, Andy&nbsp;Kriebel set us a challenge to answer a question one of the candidates had asked; how to work out the minimum and maximum life expectancy for;<br /><ul><li>Each Local Authority</li><li>Each Gender</li><li>For every date range</li><li>Where there are no nulls, the metric used is average, and the age category is 'at birth'</li></ul>The reason for doing analysis like this could be to&nbsp;see whether or not there is a change in the movement of the distance between the highest and lowest 'years left to live' value. Which is actually a good idea, as if this gap widens in some areas in the same year as it gets &nbsp;smaller in others, then&nbsp;perhaps one ward is more successful than others and their practices should be implemented.<br /><br />So creating something like this (here we have the basic calculations of MIN and MAX&nbsp;in the viz) should work right?<br /><br /><a href="http://www.theinformationlab.co.uk/wp-content/uploads/2015/11/new-11.png"><img alt="new 1" class="wp-image-7003 aligncenter" height="312" src="https://www.theinformationlab.co.uk/wp-content/uploads/2015/11/new-11.png" width="580" /></a><br />No - This doesn't seem to work as the visualisation is returning the same value for minimum and maximum for each one of these marks, as it's the lowest level of granularity. The difference is obvious when you take things at the local authority level. But the question, if you remember is this; if you rank the ward by any measure then you can't compare the difference in gender, for instance or see the minimum or maximum for the life expectancy (years left to live) measure.<br /><br /><b>The Action</b><br />What we want for this one is to not allow Tableau to aggregate at the default level, but instead to determine at which level of detail Tableau should be running it's calculations.<br />So the 'level of detail' that needs to be aggregated up &amp; fixed to is at the Local Authority and Gender level. So my first attempt used a Fixed level of detail.<br />Fixed aggregates at the&nbsp;specific level of detail of the expression, regardless of what is present in the view. With this in mind, my first attempt was this.<br /><br /><a href="http://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal1.png"><img alt="cal1" class="alignnone wp-image-6961" height="17" src="https://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal1.png" width="580" /></a><br />Max LtL as { FIXED [Local Authority], [Gender] : MAX([Years Left to Live]) } for the maximum value<br /><a href="http://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal2.png"><img alt="cal2" class="alignnone wp-image-6962" height="14" src="https://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal2.png" width="580" /></a><br />Min LtL as { FIXED [Local Authority], [Gender] : MIN([Years Left to Live]) } for the minimum value<br /><a href="http://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal3.png"><img alt="cal3" class="alignnone size-full wp-image-6963" height="21" src="https://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal3.png" width="205" /></a><br />LtL Diff as [Max Ltl] - [Min Ltl]<br /><br />And the is what the result I was given was.<br /><a href="http://www.theinformationlab.co.uk/wp-content/uploads/2015/11/new-2.png"><img alt="new 2" class="wp-image-7005 aligncenter" height="312" src="https://www.theinformationlab.co.uk/wp-content/uploads/2015/11/new-2.png" width="580" /></a><br />This seems a remarkable high range, even at birth - It doesn't make sense for the minimum life expectancy for a male or female to be 70 years apart from the maximum level of detail given. For instance in the example above, we can see that for the years 1999-2003, a female in the Eastbrook ward of Barking &amp; Dagenham, the minimum years left to live is 14.9 years; a difference of almost 70 years.<br /><br />All the values for the Local Authority are now at the same level of detail, but the result definitely can't be right! (I hope!)<br /><br />However, this doesn't give the correct answer because in order for the fixed level of detail to work, all dimensions which are being addressed need to be in play within the calculation - so instead, our LOD calculation would be;<br /><br /><a href="http://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal4.png"><img alt="cal4" class="alignnone wp-image-6965" height="9" src="https://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal4.png" width="580" /></a><br />Max LtL as { FIXED [Local Authority], [Gender], [Metric],[Age Category],[Date Range] : MAX([Years Left to Live]) } for the maximum value<br /><br /><a href="http://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal5.png"><img alt="cal5" class="alignnone wp-image-6966" height="10" src="https://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal5.png" width="580" /></a><br />Min LtL as { FIXED [Local Authority], [Gender], [Metric],[Age Category],[Date Range] : MIN([Years Left to Live]) } for the minimum value<br /><br /><a href="http://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal3.png"><img alt="cal3" class="alignnone size-full wp-image-6963" height="21" src="https://www.theinformationlab.co.uk/wp-content/uploads/2015/11/cal3.png" width="205" /></a><br />LtL Diff stays as [Max Ltl] - [Min Ltl]<br /><br />Giving us this<br /><a href="http://www.theinformationlab.co.uk/wp-content/uploads/2015/11/new-3.png"><img alt="new 3" class="wp-image-7006 aligncenter" height="312" src="https://www.theinformationlab.co.uk/wp-content/uploads/2015/11/new-3.png" width="580" /></a><br />Much better. Now in the years&nbsp;1999-2003, a female in the Eastbrook ward of Barking &amp; Dagenham has a minimum life expectancy of 77.4 years, with a small difference of 5.1 years. This seems to be correct.<br /><br /><b>The Lesson</b><br />So, the question was&nbsp;how to work out the minimum and maximum life expectancy for;<br /><ul><li>Each Local Authority</li><li>Each Gender</li><li>For every date range</li><li>Where there are no nulls, the metric used is average, and the age category is 'at birth'</li></ul>And in order to do this, all the dimensions (blue pills) in the view must be included in the Level of Detail calculation. As you can see, before the colon you have every pill which is in the view. In order for the calculation to work, every dimension which is in the view must be taken in the calculation. This makes sure that all of these are held as fixed, meaning that the calculation is left at this high level of detail.<br /><br />After conversing with Chris Love about this post, he mentioned that the first attempt can also be remedied&nbsp;using context filters. This is because the FIXED level of detail calculation doesn't take filters into account unless they are in context. So adding Metric and Age Category to context also works in this instance.<br /><br />The reason for sharing this was to show an example where understanding how the " { FIXED " function can be used, but also to highlight once more that within Tableau, there is more than one way to reach a solution.<br /><br />Have a look at the workbook I've uploaded Tableau Public; click on the image below to have it pop up.<br /><br />It's got the two sheets - My first attempt, and second, with the data attached for you to explore further and understand the exercise.<br /><a href="https://public.tableau.com/views/LifeExpectancyintheUK-FixedLODexample/MyFirstAttempt?:embed=y&amp;:display_count=yes&amp;:showTabs=y"><img alt="new 4" class="aligncenter wp-image-7008" height="437" src="https://www.theinformationlab.co.uk/wp-content/uploads/2015/11/new-4.png" width="580" /></a><br /><br />If I've made any errors in how I've communicated or explained this, please let me know so I can edit the post accordingly, and more importantly, carry on learning.